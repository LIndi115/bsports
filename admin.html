<!DOCTYPE html>
<html lang="sq">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin | Genti Term</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
        .box { background: #1e293b; padding: 30px; border-radius: 20px; width: 100%; max-width: 350px; border: 1px solid #334155; }
        input, button { width: 100%; padding: 12px; margin-top: 15px; border-radius: 10px; border: 1px solid #334155; background: #0f172a; color: white; box-sizing: border-box; }
        button { background: #007aff; border: none; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <div class="box">
        <h2 style="color:#007aff; text-align:center;">Shto Punim</h2>
        <input type="text" id="t" placeholder="Titulli i punimit">
        <input type="text" id="p" placeholder="Përshkrimi (opsionale)">
        <input type="file" id="f" accept="image/*">
        <button id="btn" onclick="upload()">PUBLIKO TANI</button>
        <p id="st" style="margin-top:15px; color:#94a3b8; font-size:12px; text-align:center;">Gati.</p>
    </div>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyBh_7BwfNbKbscPSW1ZN9Y_UvAntsj19Wg",
            authDomain: "herolind-6ca5f.firebaseapp.com",
            projectId: "herolind-6ca5f",
            storageBucket: "herolind-6ca5f.firebasestorage.app",
            messagingSenderId: "893085364638",
            appId: "1:893085364638:web:2db59e6ec72ad7e7c1a68f"
        };
        firebase.initializeApp(firebaseConfig);
        async function upload() {
            const file = document.getElementById('f').files[0];
            const tit = document.getElementById('t').value;
            const per = document.getElementById('p').value;
            const btn = document.getElementById('btn');
            const st = document.getElementById('st');
            if(!file || !tit) return alert("Plotëso titullin dhe zgjidh foton!");
            btn.disabled = true; st.innerText = "Duke u ngarkuar...";
            try {
                const ref = firebase.storage().ref('p/' + Date.now() + file.name);
                await ref.put(file);
                const url = await ref.getDownloadURL();
                await firebase.firestore().collection("projekte").add({
                    titulli: tit, pershkrimi: per, imageUrl: url, timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                alert("Punimi u postua me sukses!");
                location.reload();
            } catch (e) { alert("Gabim! Sigurohu që Storage Rules janë 'true'."); btn.disabled = false; }
        }
    </script>
</body>
</html>
